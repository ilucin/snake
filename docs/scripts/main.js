"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}SnakeGame.ProductiveAbuser=function(){function e(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent.trim()}function t(e,t,n,o){return e.relationships[n].data?t.find(function(t){return t.type===o&&t.id===e.relationships[n].data.id}):null}function n(e){this.config=e}return Object.assign(n.prototype,{connect:function(){var e=this,t=this.config,n=t.realtimeHost,o=t.personId,i=t.token,r=this.socket=window.io(n,{path:"",autoConnect:!0});r.on("connect",function(){r.emit("join",{token:i,person_id:o})}),r.on("new-notification",function(){e._onSocketNewNotification.apply(e,arguments)})},disconnect:function(){this.socket.disconnect(),this.socket.off()},onChannelMessage:function(e){this._onChannelMessageHandler=e},fetchChannels:function(){var e=this.config.projectId;return this._depaginatedQuery("tasks","filter[project_id]="+e+"&filter[status]=1").then(function(e){return e.reduce(function(e,n){return n.data.reduce(function(e,o){var i=o.attributes.tag_list.slice(),r=t(o,n.included,"assignee","people");return e.concat({id:o.id,name:o.attributes.title,tags:i,owner:r})},e)},[])})},fetchMessagesForChannel:function(n){return this._depaginatedQuery("activities","filter[task_id]="+n).then(function(n){return n.reduce(function(n,o){return o.data.filter(function(e){return"comment"===e.attributes.item_type}).reduce(function(n,i){var r=o.included.find(function(e){return e.id===String(i.attributes.item_id)});if(r&&!r.attributes.deleted_at){var a=t(r,o.included,"person","people");n.push({id:r.id,text:e(r.attributes.body),person:a})}return n},n)},[])})},_query:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=this.config,r=i.apiHost,a=i.organizationId,s=i.token;return fetch(encodeURI(r+"/api/v2/"+a+"/"+e+"?per_page="+n+"&page="+o+"&"+t+"&token="+s)).then(function(e){return e.json()})},_depaginatedQuery:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=1,r=[],a=function a(){return n._query(e,t,o,i).then(function(e){return r.push(e),i<e.meta.total_pages?(i++,a()):r})};return Promise.resolve().then(a)},_onSocketNewNotification:function(n){var o=this;this._query("notifications","filter[id]="+n.notification_id,1).then(function(n){return o._onNewNotification({channelId:String(n.data[0].attributes.target_id),creator:t(n.data[0],n.included,"actor","people"),message:e(n.data[0].attributes.excerpt)})})},_onNewNotification:function(e){this._onChannelMessageHandler&&this._onChannelMessageHandler(e)}}),n}(),SnakeGame.Evented=function(){function e(e,t){if(!t)throw new Error(e)}return function(t){function n(t,n){e("ev has to be a string",t&&"string"==typeof t),e("clb has to be a function",n&&"function"==typeof n),r[t]=r[t]||[],r[t].push(n)}function o(e,t){if(e){if(r[e])if(t){var n=r[e].indexOf(t);n>=0&&r[e].splice(n,1)}else r[e]=[]}else r={}}function i(e){if(r[e]){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];for(var i=0;i<r[e].length;i++){var a;(a=r[e])[i].apply(a,n)}}}var r={};return Object.assign(t,{on:n,off:o,trigger:i})}}(),SnakeGame.Enums=function(){return{Direction:{UP:1,DOWN:2,RIGHT:3,LEFT:4,RELATIVE_RIGHT:5,RELATIVE_LEFT:6},Collision:{SNAKE_TO_FOOD:1,SNAKE_TO_SNAKE:2}}}(),SnakeGame.Consts=function(){var e={realtimeHost:"http://localhost:3000",apiHost:"http://api.productive.io.dev",token:"3fd23548-1605-4202-a6f1-c0580fd927d2",personId:"193",projectId:"102",organizationId:"16"},t={realtimeHost:"https://realtime.productive.io",apiHost:"https://api.productive.io",personId:"13892",projectId:"23",organizationId:"1"},n=location.search.slice(1).split("&").find(function(e){return 0===e.indexOf("config=")}).split("=")[1],o=void 0;return n&&(o=JSON.parse(atob(decodeURIComponent(n)))),{config:Object.assign({},"development"===window.ENV?e:t,o),CELL_SIZE:50,FRAME_RATE_DROP:10,EMPTY_CELL:"empty",SNAKE_CELL:"snake",FOOD_CELL:"food",MAX_CYCLE_BETWEEN_FOOD:5,MAX_FOOD:1e4,MAX_FOOD_DURATION:150,MIN_FOOD_DURATION:50,BOT_SNAKE:!0}}(),SnakeGame.Utils=function(){function e(e,t){return Math.floor(Math.random()*(t-e)+e)}function t(t){return t[e(0,t.length)]}function n(){return t(r)}function o(){return t(a)}var i=SnakeGame.Enums.Direction,r=[i.UP,i.DOWN,i.LEFT,i.RIGHT],a=["Xandra","Xavier","Xeus","Xenia","Xenon","Xena","Xerxes","Xexilia","Xadrian","Xiu"];return{randomInt:e,pickRandom:t,getRandomNonRelativeDirection:n,getRandomName:o}}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();SnakeGame.Classes=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.x=t,this.y=n}return _createClass(e,[{key:"normalizeForDimensions",value:function(e,t){this.x%=e,this.y%=t,this.x<0&&(this.x=e+this.x),this.y<0&&(this.y=t+this.y)}},{key:"clone",value:function(){return new e(this.x,this.y)}}]),e}(),t=function e(){_classCallCheck(this,e),this._cells=[]};return{Position:e,CellCollection:t}}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();SnakeGame.FoodController=function(){var e=SnakeGame.Consts,t=e.MAX_CYCLE_BETWEEN_FOOD,n=e.MAX_FOOD,o=e.MAX_FOOD_DURATION,i=e.MIN_FOOD_DURATION,r=SnakeGame.Utils.randomInt,a=SnakeGame.Classes.Position,s=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.className="food",e}return _inherits(t,e),t}(a),u=function(){function e(){_classCallCheck(this,e),this.config={maxFood:n,maxCycleBetweenFood:t,maxDuration:o,minDuration:i},this.food=[]}return _createClass(e,[{key:"destroyOldFood",value:function(){var e=this;return this.food.reduce(function(t,n,o){return 0===--n.duration&&(e.food.splice(o,1),t.push(n)),t},[])}},{key:"generateNewFood",value:function(e){if(this.shouldGenerateFood()){var t=e();if(t){var n=new s(t.x,t.y);return n.duration=r(this.config.minDuration,this.config.maxDuration),this.food.push(n),n}}return!1}},{key:"removeFoodUnitAt",value:function(e){for(var t=this.food,n=0;n<t.length;n++)if(t[n].x===e.x&&t[n].y===e.y)return t.splice(t.indexOf(t[n]),1),!0;return!1}},{key:"getPositions",value:function(){return this.food}},{key:"shouldGenerateFood",value:function(){return this.food.length<this.config.maxFood&&Math.random()<=1/this.config.maxCycleBetweenFood}}]),e}();return u}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();SnakeGame.Grid=function(){var e=SnakeGame.Consts.EMPTY_CELL,t=SnakeGame.Classes.Position,n=SnakeGame.Utils,o=n.randomInt,i=n.pickRandom,r=function(){function n(t,o){_classCallCheck(this,n),this.width=t,this.height=o;for(var i={},r=0;r<o;r++){i[r]={};for(var a=0;a<t;a++)i[r][a]=e}this._grid=i}return _createClass(n,[{key:"setCell",value:function(e,t){this._grid[e.y][e.x]=t}},{key:"getCell",value:function(e){return this._grid[e.y][e.x]}},{key:"getRandomEmptyPosition",value:function(){for(var n=void 0,r=0;r<5;r++)if(n=new t(o(0,this.width),o(0,this.height)),this.getCell(n)===e)return n;var a=this._grid;return i(Object.keys(a).reduce(function(n,o){var i=[];return Object.keys(a[o]).forEach(function(n){a[o][n]===e&&i.push(new t(n,o))}),n.concat(i)},[]))}}]),n}();return r}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();SnakeGame.Snake=function(){var e=window.SnakeGame,t=e.Enums.Direction,n=e.Classes,o=n.Position,i=n.CellCollection,r={};r[t.UP]=t.LEFT,r[t.LEFT]=t.DOWN,r[t.DOWN]=t.RIGHT,r[t.RIGHT]=t.UP;var a={};a[t.UP]=t.RIGHT,a[t.RIGHT]=t.DOWN,a[t.DOWN]=t.LEFT,a[t.LEFT]=t.UP;var s=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.className="snake",e}return _inherits(t,e),t}(o),u=function(e){function n(e,t){_classCallCheck(this,n);var o=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return o._cells.push(new s(e.x,e.y)),o._direction=t,o._stomach=[],o._scheduledDirectionChanges=[],o.alive=!0,o.score=0,o}return _inherits(n,e),_createClass(n,[{key:"isValidDirectionChange",value:function(e){var n=this._direction;return e&&(e===t.UP&&n!==t.DOWN||e===t.DOWN&&n!==t.UP||e===t.RIGHT&&n!==t.LEFT||e===t.LEFT&&n!==t.RIGHT)}},{key:"updateDirection",value:function(){var e=this._scheduledDirectionChanges,t=void 0,n=void 0;do t=e.shift(),n=this.isValidDirectionChange(t);while(!n&&e.length>0);n&&(this._direction=t)}},{key:"scheduleDirectionChange",value:function(e){var n=e;e===t.RELATIVE_LEFT?n=r[this._direction]:e===t.RELATIVE_RIGHT&&(n=a[this._direction]),this._scheduledDirectionChanges.push(n)}},{key:"getTailPosition",value:function(){return this._cells[this._cells.length-1]}},{key:"getHeadPosition",value:function(){return this._cells[0]}},{key:"getPositions",value:function(){return this._cells}},{key:"getLength",value:function(){return this._cells.length}},{key:"moveInsideOfDimensions",value:function(e,n){for(var o=this._cells,i=this._direction,r=o.length-1;r>0;r--)o[r]=o[r-1].clone();var a=o[0].clone();i===t.RIGHT?a.x++:i===t.LEFT?a.x--:i===t.UP?a.y--:i===t.DOWN&&a.y++,a.normalizeForDimensions(e,n),o[0]=a}},{key:"addCellAt",value:function(e){this._cells.push(new s(e.x,e.y))}},{key:"feed",value:function(){var e=this.getHeadPosition();return this._stomach.push({processCycle:this.getLength(),position:e.clone()}),e}},{key:"processFood",value:function(){var e=this;this._stomach.forEach(function(t){0===--t.processCycle&&(e.addCellAt(t.position),e._stomach.splice(e._stomach.indexOf(t),1))})}},{key:"setCollision",value:function(e){this.collision=e}},{key:"getCollision",value:function(){return this.collision}},{key:"kill",value:function(){this.alive=!1}},{key:"isAlive",value:function(){return this.alive}}]),n}(i);return u}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();SnakeGame.BotSnake=function(){var e=SnakeGame.Utils.getRandomNonRelativeDirection,t=function(t){function n(){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments));return e.name="BOT",e}return _inherits(n,t),_createClass(n,[{key:"decideOnNextMove",value:function(){Math.random()>.8&&this.scheduleDirectionChange(e())}}]),n}(SnakeGame.Snake);return t}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();SnakeGame.PlayerSnake=function(){var e=function(e){function t(e,n,o){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,o));return i.name=e,i}return _inherits(t,e),_createClass(t,[{key:"getInputHandler",value:function(){var e=this;return function(t){return e.scheduleDirectionChange(t)}}}]),t}(SnakeGame.Snake);return e}(),SnakeGame.Canvas=function(){function e(){l.style.width=f*r+"px",l.style.height=d*r+"px";for(var e=document.createDocumentFragment(),t=0;t<d;t++){var n=document.createElement("div");n.classList.add("cell-row"),h[t]={};for(var o=0;o<f;o++){var i=document.createElement("div");h[t][o]={x:o,y:t,el:i,state:u},i.classList.add("cell"),i.style.width=r+"px",i.style.height=r+"px",n.appendChild(i)}e.appendChild(n)}l.appendChild(e)}function t(e){function t(){n%=100,++n%a===0&&e(),window.requestAnimationFrame(t)}var n=0;window.requestAnimationFrame(t)}function n(e,t,n,o,i){var r=h[t][e];r.renderCycle=i,r.state!==n&&(r.el.setAttribute("class","cell "+n+" "+n+"--"+o),r.state=n,n!==u?p.push(r):p.splice(p.indexOf(r),1))}function o(e){v++,v%=2;for(var t=e.snakes,o=0;o<t.length;o++)for(var i=t[o].getPositions(),r=0;r<i.length;r++)n(i[r].x,i[r].y,s,o,v);for(var a=e.food.getPositions(),l=0;l<a.length;l++)n(a[l].x,a[l].y,c,l,v);for(var f=p.slice(),d=0;d<f.length;d++)f[d].renderCycle!==v&&n(f[d].x,f[d].y,u,d,v)}var i=SnakeGame.Consts,r=i.CELL_SIZE,a=i.FRAME_RATE_DROP,s=i.SNAKE_CELL,u=i.EMPTY_CELL,c=i.FOOD_CELL,l=document.querySelector(".canvas"),f=Math.floor(l.getBoundingClientRect().width/r),d=Math.floor(l.getBoundingClientRect().height/r),h={},p=[],v=0;return{init:e,startFrameLoop:t,render:o,screenWidth:f,screenHeight:d}}(),SnakeGame.Game=function(){function e(e,t,n){if(n===d){var o=e.getCell(t);if(o===p)return v.SNAKE_TO_FOOD;if(o===d)return v.SNAKE_TO_SNAKE}return e.setCell(t,n),null}function t(e,t){var n=e.feed();t.removeFoodUnitAt(n),e.score++}function n(e){e.processFood()}function o(t,n){e(t,n.getTailPosition(),h),n.moveInsideOfDimensions(t.width,t.height),n.setCollision(e(t,n.getHeadPosition(),d))}function i(e){e.kill()}function r(e,n){var o=e.getCollision();o===v.SNAKE_TO_FOOD?t(e,n):o===v.SNAKE_TO_SNAKE&&i(e)}function a(t,n){n.destroyOldFood();var o=n.generateNewFood(function(){return t.getRandomEmptyPosition()});o&&e(t,o,p)}function s(e){e.updateDirection()}function u(e,t,n){e.decideOnNextMove(t,n)}function c(e,t){var n=e.filter(function(e){return e.isAlive()});0===n.length&&t()}function l(e,t,i,l){function f(){_.forEach(function(e){return u(e,d,h)}),p.forEach(function(e){return s(e)}),p.forEach(function(e){return o(d,e)}),p.forEach(function(e){return r(e,h)}),p.forEach(function(e){return n(e)}),c(p,l),a(d,h)}for(var d=new y(t,i),h=new k,p=[],v=0;v<e;v++)p.push(new E(m(),d.getRandomEmptyPosition(),g()));var _=p.filter(function(e){return e instanceof C}),O=p.filter(function(e){return e instanceof E}),b=O.map(function(e){return e.getInputHandler()});return{snakes:p,botSnakes:_,playerSnakes:O,food:h,frameLoop:f,inputMoveHandlers:b}}var f=SnakeGame.Consts,d=f.SNAKE_CELL,h=f.EMPTY_CELL,p=f.FOOD_CELL,v=SnakeGame.Enums.Collision,_=SnakeGame.Utils,g=_.getRandomNonRelativeDirection,m=_.getRandomName,y=SnakeGame.Grid,E=SnakeGame.PlayerSnake,C=SnakeGame.BotSnake,k=SnakeGame.FoodController;return l}(),SnakeGame.Ui=function(){function e(e,t,n){e.classList[n?"add":"remove"](t)}function t(){navigator.vibrate&&navigator.vibrate(200)}function n(){AudioContext&&!function(){v=v||new AudioContext;var e=v.createOscillator();e.connect(v.destination),e[e.start?"start":"noteOn"](),setTimeout(function(){return e[e.stop?"stop":"noteOff"]()},50)}()}function o(){g.menuInputSize.value=d.CELL_SIZE,g.menuInputSpeed.value=d.FRAME_RATE_DROP,g.menuInputFood.value=d.MAX_FOOD}function i(e){p!==e&&(p=e,g.statsScore.textContent=p,t(),n())}function r(){_.trigger(h.PAUSE),m.toggle(g.menu)}function a(){window.location.reload()}function s(){return u()}function u(e){g.body.removeEventListener("keydown",s),m.hide(g.gameStartPopup),_.trigger(h.START,e)}function c(e,t,n){g.gameEndPopupScoreValue.textContent=n,g.gameEndPopupTitle.textContent="You "+(t?"rule":"suck")+"!",m.show(g.gameEndPopup)}var l=window.document,f=SnakeGame.Evented,d=SnakeGame.Consts,h={RELATIVE_LEFT:"relative-left",RELATIVE_RIGHT:"relative-right",PAUSE:"pause",UP:"keydown-arrow-up",DOWN:"keydown-arrow-down",LEFT:"keydown-arrow-left",RIGHT:"keydown-arrow-right",START:"start"},p=void 0,v=void 0,_=f({}),g=Array.prototype.slice.call(l.querySelectorAll("[js]")).reduce(function(e,t){return e[t.getAttribute("js")]=t,e},{}),m=function(){function t(t){r||(e(t,"is-shown",!0),e(g.body,"is-popup-shown",!0),r=t)}function n(){r&&(e(r,"is-shown",!1),e(g.body,"is-popup-shown",!1),r=null)}function o(e){return r?n():t(e)}function i(e){return r===e}var r=null;return{show:t,hide:n,toggle:o,isShown:i}}();return g.body.addEventListener("keydown",s),g.mobileControlLeft.addEventListener("touchstart",function(){return _.trigger(h.RELATIVE_LEFT)}),g.mobileControlRight.addEventListener("touchstart",function(){return _.trigger(h.RELATIVE_RIGHT)}),g.mobileControlMenu.addEventListener("click",r),g.gameEndPopupNewGameButton.addEventListener("click",a),g.gameStartPopupStartGameButton.addEventListener("click",s),l.addEventListener("keydown",function(e){40===e.which?_.trigger(h.DOWN):39===e.which?_.trigger(h.RIGHT):38===e.which?_.trigger(h.UP):37===e.which?_.trigger(h.LEFT):80===e.which&&r()}),o(),m.show(g.gameStartPopup),Object.assign(_,{UiEvent:h,updateStats:i,showGameEndPopup:c,start:u,pause:r})}(),function(){var e=SnakeGame.Canvas,t=e.screenWidth,n=e.screenHeight,o=e.render,i=e.init,r=e.startFrameLoop,a=SnakeGame.Enums.Direction,s=SnakeGame.Game,u=SnakeGame.Ui,c=u.UiEvent,l=window.productive=new SnakeGame.ProductiveAbuser(SnakeGame.Consts.config);l.connect(),l.fetchChannels().then(function(e){var t=e.filter(function(e){return e.tags.includes("snake")})[0],n={},o=0;return t?void l.onChannelMessage(function(e){if(e.channelId===t.id){var i=e.message.toLowerCase();0===i.indexOf("player")&&(n[e.creator.id]=o++),0===i.indexOf("start")&&(0===o&&(n[e.creator.id]=o++),u.start(o)),0===i.indexOf("pause")&&u.pause(),0===i.indexOf("left")&&u.trigger(c.LEFT,n[e.creator.id]),0===i.indexOf("right")&&u.trigger(c.RIGHT,n[e.creator.id]),0===i.indexOf("up")&&u.trigger(c.UP,n[e.creator.id]),0===i.indexOf("down")&&u.trigger(c.DOWN,n[e.creator.id])}}):void window.alert("Snake game not found")}),u.on(c.START,function(e){function l(){f=!f,document.body.classList[f?"add":"remove"]("is-game-paused")}var f=!1,d=!1;i();var h=s(e||1,t,n,function(){d=!0,f=!0,u.off();var e=h.playerSnakes[0];u.showGameEndPopup(e.name,e.isAlive(),e.score)});u.on(c.PAUSE,function(){return l()}),u.on(c.RELATIVE_LEFT,function(e){return h.inputMoveHandlers[e||0](a.RELATIVE_LEFT)}),u.on(c.RELATIVE_RIGHT,function(e){return h.inputMoveHandlers[e||0](a.RELATIVE_RIGHT)}),u.on(c.DOWN,function(e){return h.inputMoveHandlers[e||0](a.DOWN)}),u.on(c.RIGHT,function(e){return h.inputMoveHandlers[e||0](a.RIGHT)}),u.on(c.UP,function(e){return h.inputMoveHandlers[e||0](a.UP)}),u.on(c.LEFT,function(e){return h.inputMoveHandlers[e||0](a.LEFT)}),r(function(){f||d||(h.frameLoop(),u.updateStats(h.playerSnakes[0].score),o(h))})})}();